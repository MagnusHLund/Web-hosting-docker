# Use the official Alpine Linux as a parent image
FROM alpine:latest

# Install dependencies
RUN apk update && apk add --no-cache \
    php \
    python3 \
    nodejs \
    npm \
    git \
    nginx \
    gettext

# Copy the Nginx configuration template
COPY nginx.conf.template /etc/nginx/nginx.conf.template

# Create directories
RUN mkdir -p /app/src /app/config

# Set the working directory
WORKDIR /app

# Copy the current directory contents into the container at /app
COPY . /app

# Expose port 80
EXPOSE 80

# Define the command to run the application
CMD envsubst < /etc/nginx/nginx.conf.template > /etc/nginx/nginx.conf && nginx -g 'daemon off;'